<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gloomhaven Digital Tabletop</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <!-- Tile Palette -->
        <div class="tile-palette">
            <h3>Tiles & Tokens</h3>
            <div class="controls-top">
                <button id="saveMap" class="btn btn-small">üíæ Save Map As...</button>
                <button id="loadMap" class="btn btn-small">üìÇ Load Map</button>
                <button id="downloadMap" class="btn btn-small">‚¨áÔ∏è Download</button>
                <button id="importMap" class="btn btn-small">‚¨ÜÔ∏è Import</button>
                <button id="clearMap" class="btn btn-small">üóëÔ∏è Clear Map</button>
            </div>
            <input type="file" id="fileInput" accept=".json" style="display: none;" />
            
            <!-- Search Filter -->
            <div class="palette-search">
                <input type="text" id="tileSearch" placeholder="üîç Search tiles..." />
            </div>
            
            <!-- Map Tiles Section -->
            <div class="palette-section">
                <button class="palette-section-toggle active" onclick="togglePaletteSection('mapTiles')">
                    <span class="toggle-icon">‚ñº</span> Map Sections
                </button>
                <div id="mapTiles-list" class="tile-list">
                    <!-- Map tiles will be loaded here -->
                </div>
            </div>
            
            <!-- Tokens & Overlays Section -->
            <div class="palette-section">
                <button class="palette-section-toggle active" onclick="togglePaletteSection('tokens')">
                    <span class="toggle-icon">‚ñº</span> Tokens & Overlays
                </button>
                <div id="tokens-list" class="tile-list">
                    <!-- Tokens will be loaded here -->
                </div>
            </div>
            
            <!-- Monster Tokens Section -->
            <div class="palette-section">
                <button class="palette-section-toggle active" onclick="togglePaletteSection('monster')">
                    <span class="toggle-icon">‚ñº</span> Monster Tokens
                </button>
                <div id="monsterList" class="tile-list">
                    <!-- Monster tokens will be loaded here -->
                </div>
            </div>
            
            <div class="palette-info">
                <p>Drag tiles onto the grid to build your map</p>
            </div>
        </div>

        <!-- Main Map Area -->
        <div class="map-container">
            <div class="map-header">
                <h1>Gloomhaven Mission Board</h1>
                <div class="controls">
                    <button id="resetFog" class="btn">üå´Ô∏è Reset Fog</button>
                    <button id="revealAll" class="btn">üëÅÔ∏è Reveal All</button>
                    <button id="toggleGrid" class="btn">‚äû Toggle Grid</button>
                    <button id="resizeAll" class="btn">‚ä° Resize All</button>
                </div>
            </div>
            
            <div id="hexMap" class="hex-map">
                <div id="placementGrid" class="placement-grid">
                    <!-- Grid cells will be generated here -->
                </div>
            </div>
        </div>

        <!-- Mission Info Sidebar -->
        <div class="sidebar">
            <div class="mission-info">
                <h2 id="missionTitle">Black Barrow</h2>
                <p class="mission-number">Mission #1</p>
                
                <!-- Objectives Section -->
                <div class="info-section">
                    <button class="section-toggle active" onclick="toggleSection('objectives')">
                        <span class="toggle-icon">‚ñº</span> Objectives
                    </button>
                    <div id="objectives-content" class="section-content">
                        <textarea id="objectives" placeholder="Enter mission objectives...">Clear all enemies from the dungeon and retrieve the ancient artifact.</textarea>
                    </div>
                </div>

                <!-- Scenario Loot Section -->
                <div class="info-section">
                    <button class="section-toggle active" onclick="toggleSection('loot')">
                        <span class="toggle-icon">‚ñº</span> Scenario Loot
                    </button>
                    <div id="loot-content" class="section-content">
                        <textarea id="loot" placeholder="Enter loot information...">Treasure #12: Random Item
Treasure #65: 50 Gold
Chest: 2 Random Items</textarea>
                    </div>
                </div>

                <!-- Placed Tiles -->
                <div class="info-section">
                    <button class="section-toggle active" onclick="toggleSection('placed')">
                        <span class="toggle-icon">‚ñº</span> Placed Tiles
                    </button>
                    <div id="placed-content" class="section-content">
                        <div id="placedTiles">
                            <span class="room-tag">None</span>
                        </div>
                    </div>
                </div>

                <!-- Revealed Rooms -->
                <div class="info-section">
                    <button class="section-toggle active" onclick="toggleSection('revealed')">
                        <span class="toggle-icon">‚ñº</span> Revealed Rooms
                    </button>
                    <div id="revealed-content" class="section-content">
                        <div id="revealedRooms">
                            <span class="room-tag">None</span>
                        </div>
                    </div>
                </div>

                <!-- Introduction -->
                <div class="info-section">
                    <button class="section-toggle active" onclick="toggleSection('intro')">
                        <span class="toggle-icon">‚ñº</span> Introduction
                    </button>
                    <div id="intro-content" class="section-content">
                        <textarea id="intro" placeholder="Enter introduction text...">The entrance to the Black Barrow looms before you, ancient stone weathered by centuries of neglect. Strange sounds echo from within...</textarea>
                    </div>
                </div>

                <!-- Room Reveals -->
                <div class="info-section">
                    <button class="section-toggle" onclick="toggleSection('room1')">
                        <span class="toggle-icon">‚ñ∂</span> Room 1 Reveal
                    </button>
                    <div id="room1-content" class="section-content collapsed">
                        <textarea id="room1" placeholder="Enter room 1 text...">As you push open the heavy door, the stench of decay fills your nostrils. Undead creatures turn to face you...</textarea>
                    </div>
                </div>

                <div class="info-section">
                    <button class="section-toggle" onclick="toggleSection('room2')">
                        <span class="toggle-icon">‚ñ∂</span> Room 2 Reveal
                    </button>
                    <div id="room2-content" class="section-content collapsed">
                        <textarea id="room2" placeholder="Enter room 2 text..."></textarea>
                    </div>
                </div>

                <div class="info-section">
                    <button class="section-toggle" onclick="toggleSection('room3')">
                        <span class="toggle-icon">‚ñ∂</span> Room 3 Reveal
                    </button>
                    <div id="room3-content" class="section-content collapsed">
                        <textarea id="room3" placeholder="Enter room 3 text..."></textarea>
                    </div>
                </div>

                <!-- Special Rules -->
                <div class="info-section">
                    <button class="section-toggle active" onclick="toggleSection('rules')">
                        <span class="toggle-icon">‚ñº</span> Special Rules
                    </button>
                    <div id="rules-content" class="section-content">
                        <textarea id="rules" placeholder="Enter special rules...">- Trap damage increased by 1
- Monsters gain +1 movement
- All monsters have Shield 1</textarea>
                    </div>
                </div>

                <!-- Conclusion -->
                <div class="info-section">
                    <button class="section-toggle" onclick="toggleSection('conclusion')">
                        <span class="toggle-icon">‚ñ∂</span> Conclusion
                    </button>
                    <div id="conclusion-content" class="section-content collapsed">
                        <textarea id="conclusion" placeholder="Enter conclusion text...">With the last enemy defeated, an eerie silence falls over the barrow. The ancient artifact pulses with mysterious energy...</textarea>
                    </div>
                </div>

                <!-- Notes -->
                <div class="info-section">
                    <button class="section-toggle active" onclick="toggleSection('notes')">
                        <span class="toggle-icon">‚ñº</span> Notes
                    </button>
                    <div id="notes-content" class="section-content">
                        <textarea id="notes" placeholder="Add session notes here..."></textarea>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Load Map Modal -->
    <div id="loadMapModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Load Saved Map</h2>
                <button class="modal-close" onclick="closeLoadMapModal()">&times;</button>
            </div>
            <div class="modal-body">
                <div id="mapListContainer">
                    <!-- Map list will be populated here -->
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn" onclick="closeLoadMapModal()">Cancel</button>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>
